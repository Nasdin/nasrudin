# Codebase Report: Frontend Architecture Exploration
Generated: 2025-01-30

## Summary

The frontend is located in `nasrudin-frontend/` and uses **TanStack Start** (React framework with SSR) + **TanStack Router** for routing + **Tailwind CSS v4** for styling. The app displays physics theorems generated by the genetic algorithm engine. Currently using **mock data** - no live API integration detected.

## Project Structure

```
nasrudin-frontend/
├── public/              # Static assets (favicon, logos)
├── src/
│   ├── components/      # Reusable React components (3 components)
│   │   ├── DomainBadge.tsx
│   │   ├── TheoremCard.tsx
│   │   └── TopNav.tsx
│   ├── lib/             # Utilities and mock data
│   │   └── mock-data.ts
│   ├── routes/          # File-based routing (TanStack Router)
│   │   ├── __root.tsx   # Root layout with TopNav + footer
│   │   ├── index.tsx    # Landing page
│   │   ├── axioms.tsx   # Axioms list page
│   │   ├── engine.tsx   # Engine stats/overview
│   │   ├── search.tsx   # Search theorems
│   │   ├── timeline.tsx # Timeline of discoveries
│   │   ├── domains/
│   │   │   ├── index.tsx      # Domains list
│   │   │   └── $domain.tsx    # Domain detail
│   │   ├── theorem/
│   │   │   └── $theoremId.tsx # Theorem detail + calculator
│   │   ├── explore/
│   │   │   └── $theoremId.tsx # Graph visualization (ReactFlow)
│   │   └── demo/        # Demo pages (TanStack Start examples)
│   ├── data/            # Demo data (punk songs example)
│   ├── router.tsx       # Router configuration
│   ├── routeTree.gen.ts # Auto-generated route tree
│   ├── styles.css       # Global CSS + Tailwind imports
│   └── logo.svg
├── package.json
├── tsconfig.json
├── vite.config.ts
└── biome.json           # Biome formatter/linter config
```

## Questions Answered

### Q1: Where is the frontend code?
**Location:** `/Users/nasdin/code/personal/physics-generator/nasrudin-frontend/`

**Key Directories:**
- `src/routes/` - Page components (file-based routing)
- `src/components/` - Reusable components
- `src/lib/mock-data.ts` - Mock data for theorems, axioms, stats

### Q2: What framework is used?
**Framework:** React 19.2.4 with TanStack Start (SSR framework)

**Key Technologies:**
- **TanStack Start** - Full-stack React framework (like Next.js but TanStack-native)
- **TanStack Router** - File-based routing with type safety
- **TanStack React Query** - Data fetching/caching (installed but not actively used yet)
- **Nitro** - Deployment/build system (nightly build)
- **Vite 7.3.1** - Build tool

### Q3: Component Structure
**Total Components:** 3 main UI components

| Component | Location | Purpose |
|-----------|----------|---------|
| `TopNav` | `components/TopNav.tsx` | Navigation bar with links to Domains, Axioms, Timeline, Engine |
| `TheoremCard` | `components/TheoremCard.tsx` | Displays theorem with LaTeX, domain badge, fitness, generation |
| `DomainBadge` | `components/DomainBadge.tsx` | Colored badge for physics domains (6 domains) |

**Component Pattern:** Functional components with TypeScript interfaces for props.

### Q4: Design System / CSS Framework
**Framework:** Tailwind CSS v4.1.18

**Styling Approach:**
- Utility-first CSS via Tailwind
- Global styles in `src/styles.css` with CSS custom properties
- Inter font from Google Fonts
- KaTeX CSS for LaTeX rendering

**Color Palette:**
```css
--bg: #FFFFFF
--bg-subtle: #F8FAFC
--text: #0F172A
--accent: #1E40AF (blue)
```

**Domain Colors:**
- Classical Mechanics: Blue
- Electromagnetism: Amber
- Special Relativity: Red
- General Relativity: Rose
- Quantum Mechanics: Violet
- Thermodynamics: Emerald

### Q5: API Communication
**Status:** ✗ NO LIVE API INTEGRATION

**Current State:**
- All data comes from `src/lib/mock-data.ts`
- No `fetch` calls found except in demo pages (`routes/demo/start.api-request.tsx`)
- TanStack React Query is installed but not used in production pages

**Mock Data Structure:**
```typescript
interface Theorem {
  id: string;
  latex: string;
  domain: string;
  depth: number;
  fitness: number;
  generation: number;
  timestamp?: string;
  operator?: string;
  name?: string;
  variables?: TheoremVariable[];
  computation?: TheoremCompute;
}

interface Stats {
  total_theorems: number;
  rate: number;
  generation: number;
  verified_pct: number;
}
```

**API Communication Pattern (Planned):**
- TanStack React Query for data fetching
- Server functions via `createServerFn` (TanStack Start pattern)
- Example in `routes/demo/start.api-request.tsx` shows `fetch('/demo/api/names')`

### Q6: Existing Pages/Views

| Route | File | Purpose |
|-------|------|---------|
| `/` | `routes/index.tsx` | Landing page with hero, stats, recent theorems |
| `/domains` | `routes/domains/index.tsx` | Grid of 6 physics domains |
| `/domains/:domain` | `routes/domains/$domain.tsx` | Theorems filtered by domain |
| `/axioms` | `routes/axioms.tsx` | List of axioms by domain |
| `/theorem/:id` | `routes/theorem/$theoremId.tsx` | Theorem detail + calculator widget |
| `/explore/:id` | `routes/explore/$theoremId.tsx` | Graph visualization with ReactFlow |
| `/timeline` | `routes/timeline.tsx` | Chronological discovery timeline |
| `/engine` | `routes/engine.tsx` | Engine stats dashboard |
| `/search` | `routes/search.tsx` | Search theorems (client-side filter) |

**Demo Routes:** `routes/demo/*` - TanStack Start examples (SSR, API routes, server functions)

### Q7: Error Handling Patterns
**Status:** ✗ MINIMAL ERROR HANDLING

**Current Patterns:**
- Basic "not found" checks in detail pages (e.g., `theorem/$theoremId.tsx`)
- No API error handling (because no API calls yet)
- No error boundaries detected
- No loading states implemented

**Example (Theorem Detail):**
```typescript
if (!theorem) {
  return (
    <div className="p-8 max-w-3xl mx-auto text-center">
      <h1>Theorem not found</h1>
      <Link to="/">Back to search</Link>
    </div>
  );
}
```

## Architecture Map

```
[Browser]
    ↓
[TanStack Start SSR] ← Vite + Nitro
    ↓
[TanStack Router] ← File-based routes
    ↓
[React Components]
    ├── Layout (__root.tsx)
    │   ├── TopNav
    │   └── Footer
    └── Pages (routes/)
        ├── Landing
        ├── Domains
        ├── Theorems
        ├── Axioms
        ├── Timeline
        ├── Engine Dashboard
        └── Search
    ↓
[Mock Data] (lib/mock-data.ts)
    ↑
(Future: Backend API at /engine API)
```

## Key Files

| File | Purpose | Entry Points |
|------|---------|--------------|
| `src/router.tsx` | Router config | `getRouter()` |
| `src/routes/__root.tsx` | Root layout | `RootDocument`, `RootLayout` |
| `src/lib/mock-data.ts` | Mock data | `mockTheorems`, `mockAxioms`, `mockStats` |
| `vite.config.ts` | Build config | Vite plugins, Tailwind, TanStack Start |
| `package.json` | Dependencies | Scripts: `dev`, `build`, `preview` |

## Conventions Discovered

### Naming
- **Files:** kebab-case (`theorem-card.tsx` style)
- **Components:** PascalCase (`TheoremCard`)
- **Functions:** camelCase (`getRouter`)
- **Dynamic routes:** `$param.tsx` syntax (e.g., `$theoremId.tsx`)

### File Organization
- **Routes:** File-based in `routes/` (mirrors URL structure)
- **Components:** Flat structure in `components/`
- **Types:** Inline interfaces in same file
- **Imports:** Path alias `@/*` maps to `src/*`

### Routing Pattern
```typescript
// Route definition
export const Route = createFileRoute('/path')({ 
  component: ComponentName 
});

// Access params
const { param } = Route.useParams();
```

### Testing
- **Framework:** Vitest 4.0.18
- **Testing Library:** React Testing Library 16.3.2
- **JSDOM:** 27.4.0
- **Status:** No test files found yet

## Technology Stack Summary

| Category | Technology | Version |
|----------|------------|---------|
| Framework | React | 19.2.4 |
| SSR/Meta-framework | TanStack Start | 1.157.16 |
| Routing | TanStack Router | 1.157.16 |
| State/Data | TanStack Query | 5.90.20 |
| Build Tool | Vite | 7.3.1 |
| Styling | Tailwind CSS | 4.1.18 |
| LaTeX | KaTeX + react-katex | 0.16.28 |
| Graphs | ReactFlow | 12.10.0 |
| Layout | Dagre | 2.0.3 |
| Icons | Lucide React | 0.563.0 |
| Linting | Biome | 2.3.13 |
| Testing | Vitest | 4.0.18 |
| Deployment | Nitro | nightly build |

## Integration Points with Backend

**Backend API Location:** `/Users/nasdin/code/personal/physics-generator/engine/crates/api/`

**Expected API Endpoints (Not Yet Implemented):**
- `GET /api/theorems` - List theorems
- `GET /api/theorems/:id` - Get theorem detail
- `GET /api/domains` - List domains
- `GET /api/axioms` - List axioms
- `GET /api/stats` - Engine statistics
- `GET /api/timeline` - Discovery timeline
- `GET /api/search?q=...` - Search theorems

**Integration Pattern (Planned):**
```typescript
// Using TanStack Query
const { data, error, isLoading } = useQuery({
  queryKey: ['theorems'],
  queryFn: () => fetch('/api/theorems').then(res => res.json())
});
```

## Open Questions

1. **Authentication:** "Login" button in TopNav is a placeholder - no auth implemented
2. **Real-time Updates:** Engine stats show real-time rate (/sec) - needs SSE or WebSocket
3. **Search Implementation:** Currently client-side filter - should be server-side for scale
4. **Verification Status:** Theorems have `verified_pct` but no UI to show verification state
5. **Proof Trees:** `/explore/:id` shows graph but data structure for derivations not defined
6. **API Schema:** Need to align mock data types with backend Rust types

## Next Steps for API Integration

1. **Replace mock data with API calls** in `lib/mock-data.ts` → `lib/api.ts`
2. **Add TanStack Query hooks** for data fetching:
   - `useTheorems()`
   - `useTheoremById(id)`
   - `useAxioms()`
   - `useStats()`
3. **Add error boundaries** for API failures
4. **Add loading states** (skeletons/spinners)
5. **Add SSE for real-time engine stats** on `/engine` page
6. **Add pagination** for theorem lists
7. **Add search debouncing** with server-side search

## File Counts

- **Total TypeScript files:** 24
- **Route files:** 17
- **Component files:** 3
- **Utility files:** 2
- **Config files:** 4 (vite, tsconfig, biome, package.json)
